<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>YinYang + Pac‑Man</title>
  <style>
    /* BLACK BACKGROUND */
    html, body {
      margin:0; padding:0;
      width:100%; height:100%;
      background:black;
      overflow:hidden;
      position:relative;
    }

    /* TWO CANVASES */
    canvas {
      position:absolute;
      top:0; left:0;
      pointer-events:none;
    }

    /* UI BUTTONS */
    #ui {
      position:absolute;
      top:20px;
      left:20px;
      z-index:10;
    }
    .btn {
      margin:0 4px 0 0;
      padding:2px 6px;
      font-size:9px;
      font-family:sans-serif;
      background:black;
      border:none;
      color:black;
      cursor:pointer;
      box-shadow:none;
      transition:background .2s, color .2s, box-shadow .2s;
    }
    .btn:hover {
      background:gold;
      color:black;
      box-shadow:0 12px 16px rgba(0,0,0,0.24),0 17px 50px rgba(0,0,0,0.19);
    }
  </style>
</head>
<body>

<div id="ui">
  <button class="btn">Option 1</button>
  <button class="btn">Option 2</button>
  <button class="btn">PushToBook</button>
  <button class="btn" id="toggle">⏯️</button>
</div>

<canvas id="bg"></canvas>
<canvas id="fg"></canvas>

<script>
  const bg = document.getElementById('bg'), bgCtx = bg.getContext('2d');
  const fg = document.getElementById('fg'), fgCtx = fg.getContext('2d');

  let W = bg.width = fg.width = window.innerWidth;
  let H = bg.height = fg.height = window.innerHeight;

  window.addEventListener('resize', () => {
    W = bg.width = fg.width = window.innerWidth;
    H = bg.height = fg.height = window.innerHeight;
  });

  const yin = new Image();
  yin.src = 'fox.jpg';

  let rot = 0;

  function drawYin() {
    const size = Math.min(W,H) * 0.5;
    bgCtx.clearRect(0,0,W,H);
    bgCtx.save();
    bgCtx.translate(W/2,H/2);
    bgCtx.rotate(rot);
    bgCtx.drawImage(yin, -size/2, -size/2, size, size);
    bgCtx.restore();
  }

  const pac = {
    x:100, y:100, vx:2, vy:1.5, speed:2.4, angle:0
  };
  const particles = [];
  const MAX = 600;
  let paused=false;

  document.getElementById('toggle').addEventListener('click', () => {
    paused = !paused;
  });

  function insideCircle(x,y) {
    const dx = x - W/2, dy = y - H/2;
    const r = Math.min(W,H)*0.5/2;
    return dx*dx + dy*dy < (r+5)*(r+5);
  }

  function wander() {
    if(insideCircle(pac.x,pac.y)) {
      const dx = pac.x - W/2, dy = pac.y - H/2;
      const d = Math.hypot(dx,dy)||1;
      pac.vx += (dx/d)*0.4;
      pac.vy += (dy/d)*0.4;
    } else {
      pac.vx += (Math.random()-0.5)*0.2;
      pac.vy += (Math.random()-0.5)*0.2;
    }
    if(pac.x<30 && pac.vx<0) pac.vx*=-0.8;
    if(pac.x>W-30 && pac.vx>0) pac.vx*=-0.8;
    if(pac.y<30 && pac.vy<0) pac.vy*=-0.8;
    if(pac.y>H-30 && pac.vy>0) pac.vy*=-0.8;

    const mag = Math.hypot(pac.vx,pac.vy)||1;
    pac.vx = pac.vx/mag * pac.speed;
    pac.vy = pac.vy/mag * pac.speed;
    pac.angle = Math.atan2(pac.vy,pac.vx);

    if(insideCircle(pac.x,pac.y)) {
      const dx = pac.x - W/2, dy = pac.y - H/2;
      const d = Math.hypot(dx,dy)||1;
      const r = Math.min(W,H)*0.5/2;
      pac.x = W/2 + dx/d*(r+5);
      pac.y = H/2 + dy/d*(r+5);
    }
  }

  class P {
    constructor(x,y){
      this.x=x;this.y=y;
      const a=Math.random()*2*Math.PI;
      this.vx=Math.cos(a)*(Math.random()+0.5);
      this.vy=Math.sin(a)*(Math.random()+0.5);
      this.size=Math.random()*3+2;
      this.alpha=0.7;
      const hue=200+Math.random()*60+Math.abs((pac.angle/Math.PI)*60);
      this.color=`hsla(${hue},80%,85%,`;
    }
    update(){
      this.x+=this.vx; this.y+=this.vy;
      this.alpha*=0.98; this.size*=0.98;
    }
    draw(){
      fgCtx.save();
      fgCtx.globalAlpha=this.alpha;
      fgCtx.fillStyle=this.color+this.alpha+')';
      fgCtx.shadowColor='#fff';
      fgCtx.shadowBlur=3;
      fgCtx.beginPath();
      fgCtx.arc(this.x,this.y,this.size,0,2*Math.PI);
      fgCtx.fill();
      fgCtx.restore();
    }
  }

  function animate() {
    rot -= 0.005;
    drawYin();

    if(!paused) {
      wander();
      pac.x=(pac.x+W)%W;
      pac.y=(pac.y+H)%H;

      if(!insideCircle(pac.x,pac.y)) {
        particles.push(new P(pac.x,pac.y));
        if(particles.length>MAX) particles.splice(0,10);
      }

      fgCtx.clearRect(0,0,W,H);
      fgCtx.globalCompositeOperation='lighter';
      for(let i=particles.length-1;i>=0;i--){
        particles[i].update();
        if(particles[i].alpha<0.05) particles.splice(i,1);
        else particles[i].draw();
      }
      fgCtx.globalCompositeOperation='source-over';

      fgCtx.save();
      fgCtx.translate(pac.x,pac.y);
      fgCtx.rotate(pac.angle);

      // shadow
      fgCtx.save();
      fgCtx.shadowColor='rgba(0,0,0,0.5)';
      fgCtx.shadowBlur=10;
      fgCtx.globalAlpha=0.5;
      fgCtx.beginPath();
      fgCtx.arc(0,8,22,0,2*Math.PI);
      fgCtx.fillStyle='#222';
      fgCtx.fill();
      fgCtx.restore();

      const mo = 0.18 + Math.abs(Math.sin(Date.now()/80 + pac.angle*2))*0.13;
      fgCtx.fillStyle='#FFDD00';
      fgCtx.beginPath();
      fgCtx.moveTo(0,0);
      fgCtx.arc(0,0,20, mo*Math.PI, (2-mo)*Math.PI);
      fgCtx.fill();
      fgCtx.restore();
    }

    requestAnimationFrame(animate);
  }

  yin.onload = animate;
</script>
</body>
</html>
